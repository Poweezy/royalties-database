<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Royalty Calculator Test</title>
</head>
<body>
  <h1>Royalty Calculator Test Page</h1>
  <div id="results"></div>

  <script type="module">
    import { RoyaltyCalculator } from '../js/modules/RoyaltyCalculator.js';

    const calculator = new RoyaltyCalculator();
    const resultsDiv = document.getElementById('results');

    function runTest(testName, testFunction) {
      try {
        testFunction();
        resultsDiv.innerHTML += `<p>${testName}: PASS</p>`;
      } catch (error) {
        resultsDiv.innerHTML += `<p>${testName}: FAIL - ${error.message}</p>`;
      }
    }

    // Fixed Rate Tests
    runTest('Fixed Rate: Standard Calculation', () => {
      const contract = { calculationType: 'fixed', calculationParams: { rate: 10 } };
      const data = { volume: 100 };
      const result = calculator.calculate(contract, data);
      if (result !== 1000) throw new Error(`Expected 1000, but got ${result}`);
    });

    // Tiered Rate Tests
    runTest('Tiered Rate: Single Tier', () => {
      const contract = {
        calculationType: 'tiered',
        calculationParams: { tiers: [{ from: 0, to: 100, rate: 10 }] },
      };
      const data = { volume: 50 };
      const result = calculator.calculate(contract, data);
      if (result !== 500) throw new Error(`Expected 500, but got ${result}`);
    });

    // Sliding Scale Tests
    runTest('Sliding Scale: Second Scale', () => {
      const contract = {
        calculationType: 'sliding_scale',
        calculationParams: {
          scales: [
            { from: 0, to: 100, rate: 10 },
            { from: 101, to: 500, rate: 12 },
          ],
        },
      };
      const data = { volume: 200 };
      const result = calculator.calculate(contract, data);
      if (result !== 2400) throw new Error(`Expected 2400, but got ${result}`);
    });
  </script>
</body>
</html>
