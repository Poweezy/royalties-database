<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mining Royalties Manager</title>
  <link rel="stylesheet" href="royalties.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Remove the problematic FontAwesome script -->
  <!-- <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script> -->
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading-screen" id="loading-screen">
    <div class="loading-spinner"></div>
    <p>Loading your workspace...</p>
  </div>

  <!-- Login Section -->
  <section class="login-section" id="login-section">
    <div class="login-container">
      <div class="login-header">
        <div class="login-logo" aria-label="Mining Royalties Manager Logo">MR</div>
        <h2>Mining Royalties Manager</h2>
        <p>Secure access to your royalty management system</p>
      </div>
      <form class="login-form">
        <div class="input-group">
          <i class="fas fa-user"></i>
          <input type="text" id="username" placeholder="Username" aria-describedby="username-error">
          <div class="validation-error" id="username-error">Username is required</div>
        </div>
        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input type="password" id="password" placeholder="Password" aria-describedby="password-error">
          <button type="button" class="password-toggle" aria-label="Toggle password visibility">
            <i class="fas fa-eye"></i>
          </button>
          <div class="validation-error" id="password-error">Password is required</div>
        </div>
        <button type="submit" class="btn btn-primary btn-large">Sign In</button>
      </form>
      <div class="login-footer">
        <p>Please contact your administrator for credentials.</p>
      </div>
    </div>
  </section>

  <!-- Main App -->
  <div class="app-container" id="app-container" style="display: none;">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo" aria-label="Mining Royalties Manager Logo">MR</div>
        <h2>Royalties Manager</h2>
      </div>
      <nav>
        <ul>
          <li><a href="#dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
          <li><a href="#user-management"><i class="fas fa-users"></i> User Management</a></li>
          <li><a href="#royalty-records"><i class="fas fa-file-invoice"></i> Royalty Records</a></li>
          <li><a href="#contract-management"><i class="fas fa-file-contract"></i> Contract Management</a></li>
          <li><a href="#audit-dashboard"><i class="fas fa-shield-alt"></i> Audit Dashboard</a></li>
          <li><a href="#reporting-analytics"><i class="fas fa-chart-bar"></i> Reporting & Analytics</a></li>
          <li><a href="#communication"><i class="fas fa-envelope"></i> Communication</a></li>
          <li><a href="#notifications"><i class="fas fa-bell"></i> Notifications <span>3</span></a></li>
          <li><a href="#compliance"><i class="fas fa-check-circle"></i> Compliance & Regulatory</a></li>
          <li><a href="#regulatory-management"><i class="fas fa-gavel"></i> Regulatory Management</a></li>
          <li><a href="#profile"><i class="fas fa-user"></i> My Profile</a></li>
          <li><a href="#logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard -->
      <section id="dashboard">
        <div class="page-header">
          <div class="page-title">
            <h1>Dashboard</h1>
            <p>Welcome back, <span id="user-name">User</span></p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Admin</button>
            <button class="btn btn-secondary">0</button>
          </div>
        </div>
        <div class="charts-grid">
          <div class="metric-card card">
            <div class="card-header">
              <h3>Total Royalties (YTD)</h3>
              <select class="metric-period">
                <option>2024</option>
                <option>2023</option>
                <option>All Time</option>
              </select>
            </div>
            <div class="card-body">
              <p id="total-royalties">E0.00</p>
              <small class="trend-positive">+0% from last year</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Active Entities</h3>
              <select class="metric-period">
                <option>This Quarter</option>
                <option>Last Quarter</option>
                <option>YTD</option>
              </select>
            </div>
            <div class="card-body">
              <p id="active-entities">0</p>
              <small class="trend-stable">No change</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Compliance Rate</h3>
            </div>
            <div class="card-body">
              <p id="compliance-rate">0%</p>
              <div class="collection-progress">
                <div class="progress-bar" style="width: 0%;"></div>
              </div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Pending Approvals</h3>
            </div>
            <div class="card-body">
              <p id="pending-approvals">0</p>
            </div>
          </div>
        </div>
        <div class="charts-grid">
          <div class="analytics-chart card">
            <div class="chart-header">
              <h5>Revenue Trends</h5>
              <div class="chart-controls">
                <button class="chart-btn active">Line</button>
                <button class="chart-btn">Bar</button>
                <button class="chart-btn">Area</button>
              </div>
            </div>
            <div class="chart-container">
              <canvas id="revenue-trends-chart"></canvas>
            </div>
          </div>
          <div class="analytics-chart card">
            <div class="chart-header">
              <h5>Production by Entity</h5>
            </div>
            <div class="chart-container">
              <canvas id="production-by-entity-chart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- User Management -->
      <section id="user-management">
        <div class="page-header">
          <div class="page-title">
            <h1>User Management</h1>
            <p>Manage users with role-based access control and security monitoring</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">View Audit Log</button>
            <button class="btn btn-primary">Export Report</button>
            <button class="btn btn-success">Add User</button>
          </div>
        </div>
        <div class="charts-grid">
          <div class="metric-card card">
            <div class="card-header">
              <h3>Active Users</h3>
            </div>
            <div class="card-body">
              <p>3</p>
              <small>Currently online</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Failed Logins</h3>
            </div>
            <div class="card-body">
              <p>0</p>
              <small>Last 24 hours</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Security Alerts</h3>
            </div>
            <div class="card-body">
              <p>None</p>
              <small>All systems secure</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Password Compliance</h3>
            </div>
            <div class="card-body">
              <p>100%</p>
              <small>Meeting security standards</small>
            </div>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Add New User</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="new-username">Username</label>
              <input type="text" id="new-username" placeholder="Username" aria-describedby="username-validation">
              <div class="validation-success" id="username-validation">‚úì Username available</div>
            </div>
            <div class="form-group">
              <label for="new-email">Email Address</label>
              <input type="email" id="new-email" placeholder="Email Address" aria-describedby="email-validation">
              <div class="validation-error" id="email-validation">Email is required</div>
            </div>
            <div class="form-group">
              <label for="new-role">Role</label>
              <select id="new-role" aria-describedby="role-validation">
                <option>Select Role</option>
                <option>üëë Admin (Full Access)</option>
                <option>‚úèÔ∏è Editor (Read/Write)</option>
                <option>üëÅÔ∏è Viewer (Read Only)</option>
                <option>üîç Auditor (Audit Access)</option>
              </select>
              <div class="validation-error" id="role-validation">Role is required</div>
            </div>
            <div class="form-group">
              <label for="new-department">Department</label>
              <select id="new-department" aria-describedby="department-validation">
                <option>Select Department</option>
                <option>üí∞ Finance</option>
                <option>‚öôÔ∏è Operations</option>
                <option>üìã Compliance</option>
                <option>üîç Audit</option>
                <option>üëî Management</option>
              </select>
              <div class="validation-error" id="department-validation">Department is required</div>
            </div>
            <div class="form-group">
              <label for="new-password">Password</label>
              <input type="password" id="new-password" placeholder="Password" aria-describedby="password-strength">
              <div class="password-strength-meter">
                <div class="strength-bar strength-weak">
                  <div class="strength-bar-fill"></div>
                </div>
                <p>Password Strength</p>
              </div>
              <div class="validation-error" id="password-strength">Password is required</div>
            </div>
            <div class="form-group">
              <label for="confirm-password">Confirm Password</label>
              <input type="password" id="confirm-password" placeholder="Confirm Password" aria-describedby="confirm-password-validation">
              <div class="validation-error" id="confirm-password-validation">Passwords must match</div>
            </div>
            <div class="form-group">
              <label for="account-expires">Account Expires</label>
              <input type="date" id="account-expires" aria-describedby="expires-validation">
              <div class="validation-error" id="expires-validation">Expiration date is required</div>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="force-password-change">
                Force password change on first login
              </label>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn btn-secondary">Cancel</button>
            <button class="btn btn-success">Create User</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>User Accounts</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="filter-role">Role</label>
              <select id="filter-role">
                <option>All Roles</option>
                <option>Admin</option>
                <option>Editor</option>
                <option>Viewer</option>
                <option>Auditor</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filter-status">Status</label>
              <select id="filter-status">
                <option>All Status</option>
                <option>Active</option>
                <option>Locked</option>
                <option>Expired</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>User</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Department</th>
                  <th>Status</th>
                  <th>Last Login</th>
                  <th>Failed Attempts</th>
                  <th>Expires</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Security Audit Log</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="audit-from-date">From Date</label>
              <input type="date" id="audit-from-date">
            </div>
            <div class="form-group">
              <label for="audit-to-date">To Date</label>
              <input type="date" id="audit-to-date">
            </div>
            <div class="form-group">
              <label for="audit-action-type">Action Type</label>
              <select id="audit-action-type">
                <option>All Actions</option>
                <option>Login</option>
                <option>Logout</option>
                <option>Create User</option>
                <option>Modify User</option>
                <option>Delete User</option>
                <option>Failed Login</option>
                <option>Password Change</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Timestamp</th>
                  <th>User</th>
                  <th>Action</th>
                  <th>Target</th>
                  <th>IP Address</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Royalty Records -->
      <section id="royalty-records">
        <div class="page-header">
          <div class="page-title">
            <h1>Royalty Records</h1>
            <p>Manage and review all royalty payments</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-success">Record Payment</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Record Royalty Payment</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="entity">Entity</label>
              <select id="entity" aria-describedby="entity-validation">
                <option>Select Entity</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
              <div class="validation-error" id="entity-validation">Entity is required</div>
            </div>
            <div class="form-group">
              <label for="mineral">Mineral</label>
              <select id="mineral" aria-describedby="mineral-validation">
                <option>Select Mineral</option>
                <option>Coal</option>
                <option>Iron Ore</option>
                <option>Green Chert</option>
                <option>Gravel</option>
                <option>River Sand</option>
                <option>Plaster Sand</option>
                <option>Quarried Stone</option>
              </select>
              <div class="validation-error" id="mineral-validation">Mineral is required</div>
            </div>
            <div class="form-group">
              <label for="volume">Volume (m¬≥)</label>
              <input type="number" id="volume" placeholder="Volume (m¬≥)" aria-describedby="volume-validation">
              <div class="validation-error" id="volume-validation">Volume must be a positive number</div>
            </div>
            <div class="form-group">
              <label for="tariff">Royalty Tariff (E/m¬≥)</label>
              <input type="number" id="tariff" placeholder="Tariff (E/m¬≥)" aria-describedby="tariff-validation">
              <div class="validation-error" id="tariff-validation">Tariff must be a positive number</div>
            </div>
            <div class="form-group">
              <label for="payment-date">Date</label>
              <input type="date" id="payment-date" aria-describedby="date-validation">
              <div class="validation-error" id="date-validation">Date is required</div>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn btn-success" id="save-royalty-btn">Save Royalty</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Royalty Records Table</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="filter-entity">Entity</label>
              <select id="filter-entity">
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
              <button class="btn btn-primary">Export Report</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Entity</th>
                  <th>Mineral</th>
                  <th>Volume (m¬≥)</th>
                  <th>Tariff (E/m¬≥)</th>
                  <th>Royalties (E)</th>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="royalty-records-tbody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Contract Management -->
      <section id="contract-management">
        <div class="page-header">
          <div class="page-title">
            <h1>Contract Management</h1>
            <p>Manage royalty agreements for mines and quarries</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-success">Add Contract</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Add Contract</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="contract-entity">Entity</label>
              <select id="contract-entity" aria-describedby="contract-entity-validation">
                <option>Select Entity</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
              <div class="validation-error" id="contract-entity-validation">Entity is required</div>
            </div>
            <div class="form-group">
              <label for="royalty-rate">Royalty Rate (E/m¬≥)</label>
              <input type="number" id="royalty-rate" placeholder="Royalty Rate (E/m¬≥)" aria-describedby="royalty-rate-validation">
              <div class="validation-error" id="royalty-rate-validation">Rate is required</div>
            </div>
            <div class="form-group">
              <label for="start-date">Start Date</label>
              <input type="date" id="start-date" aria-describedby="start-date-validation">
              <div class="validation-error" id="start-date-validation">Start date is required</div>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn btn-success">Save Contract</button>
          </div>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Entity</th>
                <th>Royalty Rate (E/m¬≥)</th>
                <th>Start Date</th>
                <th>Document</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Audit Dashboard -->
      <section id="audit-dashboard">
        <div class="page-header">
          <div class="page-title">
            <h1>Audit Dashboard</h1>
            <p>Review discrepancies and audit reports</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Export Report</button>
          </div>
        </div>
        <div class="user-form-container">
          <div class="grid-4">
            <div class="form-group">
              <label for="audit-filter-entity">Entity</label>
              <select id="audit-filter-entity">
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <h4>Discrepancies</h4>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Project</th>
                  <th>Mineral</th>
                  <th>Declared (m¬≥)</th>
                  <th>Verified (m¬≥)</th>
                  <th>Outstanding (E)</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Reporting & Analytics -->
      <section id="reporting-analytics">
        <div class="page-header">
          <div class="page-title">
            <h1>Reporting & Analytics</h1>
            <p>Comprehensive reporting, real-time analytics, and KPI dashboards for stakeholder insights</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Export Dashboard</button>
            <button class="btn btn-primary">Schedule Report</button>
            <button class="btn btn-success">Generate Report</button>
          </div>
        </div>
        <div class="charts-grid">
          <div class="metric-card card">
            <div class="card-header">
              <h3>Total Revenue (YTD)</h3>
              <select class="metric-period">
                <option>2024</option>
                <option>2023</option>
                <option>All Time</option>
              </select>
            </div>
            <div class="card-body">
              <p>E 2,847,650.00</p>
              <small class="trend-positive">+15.8% from last year</small>
              <div class="mini-chart">Trend</div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Production Volume</h3>
              <select class="metric-period">
                <option>This Quarter</option>
                <option>Last Quarter</option>
                <option>YTD</option>
              </select>
            </div>
            <div class="card-body">
              <p>485,250 m¬≥</p>
              <small class="trend-positive">+08.2% from last quarter</small>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Collection Rate</h3>
            </div>
            <div class="card-body">
              <p>96.5%</p>
              <small>Maintained high collection rate</small>
              <div class="collection-progress">
                <div class="progress-bar" style="width: 96.5%;"></div>
              </div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Outstanding Amounts</h3>
            </div>
            <div class="card-body">
              <p>E 125,400.00</p>
              <small>3 entities with overdue payments</small>
              <button class="btn btn-primary btn-sm">View Details</button>
            </div>
          </div>
        </div>
        <div class="user-form-container">
          <div class="report-tabs">
            <button class="tab-btn active" data-tab="#quick-reports">Quick Reports</button>
            <button class="tab-btn" data-tab="#custom-reports">Custom Reports</button>
            <button class="tab-btn" data-tab="#scheduled-reports">Scheduled Reports</button>
            <button class="btn tab-btn" data-tab="#audit-trail-reports">Audit Trail Reports</button>
          </div>
          <div class="tab-content active" id="quick-reports">
            <div class="quick-reports-grid">
              <div class="report-card">
                <div class="report-icon">üìä</div>
                <div class="report-info">
                  <h5>Monthly Royalty Summary</h5>
                  <p>Comprehensive overview of all royalty payments for the current month</p>
                  <div class="report-meta">
                    <span><i class="fas fa-clock"></i> 2-3 minutes</span>
                    <span><i class="fas fa-file-pdf"></i> PDF</span>
                  </div>
                </div>
                <button class="btn btn-primary">Generate</button>
              </div>
              <div class="report-card">
                <div class="report-icon">üìà</div>
                <div class="report-info">
                  <h5>Entity Performance Analysis</h5>
                  <p>Production and payment metrics by mining entity</p>
                  <div class="report-meta">
                    <span><i class="fas fa-clock"></i> 3-5 minutes</span>
                    <span><i class="fas fa-file-excel"></i> Excel</span>
                  </div>
                </div>
                <button class="btn btn-primary">Generate</button>
              </div>
              <div class="report-card">
                <div class="report-icon">üìã</div>
                <div class="report-info">
                  <h5>Compliance Status Report</h5>
                  <p>Current compliance standings and upcoming requirements</p>
                  <div class="report-meta">
                    <span><i class="fas fa-clock"></i> 1-2 minutes</span>
                    <span><i class="fas fa-file-pdf"></i> PDF</span>
                  </div>
                </div>
                <button class="btn btn-primary">Generate</button>
              </div>
              <div class="report-card">
                <div class="report-icon">üí∞</div>
                <div class="report-info">
                  <h5>Outstanding Payments</h5>
                  <p>Detailed breakdown of overdue and pending payments</p>
                  <div class="report-meta">
                    <span><i class="fas fa-clock"></i> 1 minute</span>
                    <span><i class="fas fa-file-csv"></i> CSV</span>
                  </div>
                </div>
                <button class="btn btn-primary">Generate</button>
              </div>
            </div>
          </div>
          <div class="tab-content" id="custom-reports">
            <div class="custom-report-builder">
              <div class="builder-section">
                <h5><i class="fas fa-filter"></i> Report Criteria</h5>
                <div class="grid-4">
                  <div class="form-group">
                    <label for="report-type">Report Type</label>
                    <select id="report-type" aria-describedby="report-type-validation">
                      <option>Select Report Type</option>
                      <option>Financial Analysis</option>
                      <option>Production Analysis</option>
                      <option>Compliance Tracking</option>
                      <option>Entity Performance</option>
                      <option>Audit & Verification</option>
                      <option>Comparative Analysis</option>
                    </select>
                    <div class="validation-error" id="report-type-validation">Report type is required</div>
                  </div>
                  <div class="form-group">
                    <label for="report-period">Period</label>
                    <select id="report-period" aria-describedby="period-validation">
                      <option>Select Period</option>
                      <option>Monthly</option>
                      <option>Quarterly</option>
                      <option>Yearly</option>
                      <option>Custom Range</option>
                    </select>
                    <div class="validation-error" id="period-validation">Period is required</div>
                  </div>
                  <div class="form-group">
                    <label for="report-entity">Entity</label>
                    <select id="report-entity" aria-describedby="entity-report-validation">
                      <option>All Entities</option>
                      <option>Kwalini Quarry</option>
                      <option>Mbabane Quarry</option>
                      <option>Sidvokodvo Quarry</option>
                      <option>Maloma Colliery</option>
                      <option>Ngwenya Mine</option>
                      <option>Malolotja Mine</option>
                    </select>
                    <div class="validation-error" id="entity-report-validation">Entity selection required</div>
                  </div>
                  <div class="form-group">
                    <label for="output-format">Output Format</label>
                    <select id="output-format" aria-describedby="format-validation">
                      <option>PDF</option>
                      <option>Excel</option>
                      <option>CSV</option>
                      <option>HTML</option>
                    </select>
                    <div class="validation-error" id="format-validation">Output format is required</div>
                  </div>
                </div>
              </div>
              <div class="builder-section">
                <h5><i class="fas fa-chart-bar"></i> Metrics Selection</h5>
                <div class="metrics-selector">
                  <div class="metric-category">
                    <h6>Financial Metrics</h6>
                    <div class="metric-options">
                      <label class="checkbox-label"><input type="checkbox">Total Royalties</label>
                      <label class="checkbox-label"><input type="checkbox">Outstanding Payments</label>
                      <label class="checkbox-label"><input type="checkbox">Revenue Trends</label>
                    </div>
                  </div>
                  <div class="metric-category">
                    <h6>Production Metrics</h6>
                    <div class="metric-options">
                      <label class="checkbox-label"><input type="checkbox">Volume Extracted</label>
                      <label class="checkbox-label"><input type="checkbox">Production Rate</label>
                    </div>
                  </div>
                  <div class="metric-category">
                    <h6>Compliance Metrics</h6>
                    <div class="metric-options">
                      <label class="checkbox-label"><input type="checkbox">Compliance Rate</label>
                      <label class="checkbox-label"><input type="checkbox">Audit Findings</label>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-actions">
                <button class="btn btn-secondary">Reset</button>
                <button class="btn btn-success">Preview Report</button>
              </div>
            </div>
          </div>
          <div class="tab-content" id="scheduled-reports">
            <div class="scheduled-reports-header">
              <button class="btn btn-success">Add Scheduled Report</button>
            </div>
            <div class="scheduled-reports-list">
              <div class="schedule-item">
                <div class="schedule-info">
                  <h5>Weekly Royalty Summary</h5>
                  <p>Summary of royalty payments sent every Monday</p>
                  <div class="schedule-details">
                    <span><i class="fas fa-clock"></i> Weekly on Monday at 9 AM</span>
                    <span><i class="fas fa-file-pdf"></i> PDF</span>
                    <span><i class="fas fa-envelope"></i> finance@example.com</span>
                  </div>
                </div>
                <div class="schedule-actions">
                  <button class="btn btn-primary btn-sm">Edit</button>
                  <button class="btn btn-danger btn-sm">Delete</button>
                </div>
              </div>
              <div class="schedule-item active">
                <div class="schedule-info">
                  <h5>Monthly Compliance Report</h5>
                  <p>Compliance status sent to all entities monthly</p>
                  <div class="schedule-details">
                    <span><i class="fas fa-clock"></i> Monthly on 1st at 8 AM</span>
                    <span><i class="fas fa-file-excel"></i> Excel</span>
                    <span><i class="fas fa-envelope"></i> Active</span>
                  </div>
                </div>
                <div class="schedule-actions">
                  <button class="btn btn-primary btn-sm">Edit</button>
                  <button class="btn btn-danger btn-sm">Delete</button>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-content" id="audit-trail-reports">
            <div class="report-history-controls">
              <div class="grid-4">
                <div class="form-group">
                  <label for="audit-report-from-date">From Date</label>
                  <input type="date" id="audit-report-from-date">
                </div>
                <div class="form-group">
                  <label for="audit-report-to-date">To Date</label>
                  <input type="date" id="audit-report-to-date">
                </div>
                <div class="form-group">
                  <label for="audit-report-type">Report Type</label>
                  <select id="audit-report-type">
                    <option>All Types</option>
                    <option>Financial</option>
                    <option>Production</option>
                    <option>Compliance</option>
                    <option>Audit</option>
                  </select>
                </div>
                <div class="form-group">
                  <button class="btn btn-primary">Generate Audit Report</button>
                </div>
              </div>
            </div>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Report Name</th>
                    <th>Type</th>
                    <th>Generated</th>
                    <th>By</th>
                    <th>Format</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Financial Audit Q2</td>
                    <td class="report-type financial">Financial</td>
                    <td>2024-07-01</td>
                    <td>Admin</td>
                    <td>PDF</td>
                    <td>
                      <button class="btn btn-primary btn-sm">View</button>
                      <button class="btn btn-secondary btn-sm">Download</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- Communication -->
      <section id="communication">
        <div class="page-header">
          <div class="page-title">
            <h1>Communication</h1>
            <p>Manage notifications and messages to stakeholders</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-success">Send Message</button>
            <button class="btn btn-primary">View Message History</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Send New Message</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="recipient">Recipient</label>
              <select id="recipient" aria-describedby="recipient-validation">
                <option>Select Recipient</option>
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
              <div class="validation-error" id="recipient-validation">Recipient is required</div>
            </div>
            <div class="form-group">
              <label for="message-type">Message Type</label>
              <select id="message-type" aria-describedby="message-type-validation">
                <option>Select Type</option>
                <option>Payment Reminder</option>
                <option>Compliance Notice</option>
                <option>General Announcement</option>
              </select>
              <div class="validation-error" id="message-type-validation">Message type is required</div>
            </div>
            <div class="form-group">
              <label for="subject">Subject</label>
              <input type="text" id="subject" placeholder="Subject" aria-describedby="subject-validation">
              <div class="validation-error" id="subject-validation">Subject is required</div>
            </div>
          </div>
          <div class="form-group">
            <label for="message-content">Message Content</label>
            <textarea id="message-content" rows="5" placeholder="Enter your message here" aria-describedby="content-validation"></textarea>
            <div class="validation-error" id="content-validation">Message content is required</div>
          </div>
          <div class="form-actions">
            <button class="btn btn-secondary">Cancel</button>
            <button class="btn btn-success">Send Message</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Message History</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="filter-recipient">Recipient</label>
              <select id="filter-recipient">
                <option>All Recipients</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filter-message-type">Message Type</label>
              <select id="filter-message-type">
                <option>All Types</option>
                <option>Payment Reminder</option>
                <option>Compliance Notice</option>
                <option>General Announcement</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Recipient</th>
                  <th>Type</th>
                  <th>Subject</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Notifications -->
      <section id="notifications">
        <div class="page-header">
          <div class="page-title">
            <h1>Notifications</h1>
            <p>View and manage system alerts and notifications</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Mark All as read</button>
            <button class="btn btn-primary">Clear Notifications</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Recent Notifications</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="filter-notification-type">Type</label>
              <select id="filter-notification-type">
                <option>All Types</option>
                <option>Payment Due</option>
                <option>Compliance Alert</option>
                <option>System Update</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filter-notification-status">Status</label>
              <select id="filter-notification-status">
                <option>All Statuses</option>
                <option>Unread</option>
                <option>Read</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Type</th>
                  <th>Message</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>2024-05-10</td>
                  <td class="report-type warning">Payment Due</td>
                  <td>Payment overdue for Kwalini Quarry</td>
                  <td>Unread</td>
                </tr>
                <tr>
                  <td>2024-05-09</td>
                  <td class="report-type compliance">Compliance</td>
                  <td>Compliance report submitted</td>
                  <td>Read</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Compliance -->
      <section id="compliance">
        <div class="page-header">
          <div class="page-title">
            <h1>Compliance & Regulatory Management</h1>
            <p>Ensure compliance with Eswatini mining laws, regional SADC regulations, and national fiscal requirements</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Generate Compliance Report</button>
            <button class="btn btn-success">Submit to Eswatini Revenue Authority</button>
            <button class="btn btn-secondary">View Regulatory Calendar</button>
          </div>
        </div>
        
        <!-- Compliance Dashboard -->
        <div class="charts-grid">
          <div class="metric-card card">
            <div class="card-header">
              <h3>Eswatini Compliance Rate</h3>
              <select class="metric-period">
                <option>Current Quarter</option>
                <option>Previous Quarter</option>
                <option>YTD 2024</option>
              </select>
            </div>
            <div class="card-body">
              <p>98.5%</p>
              <small class="trend-positive">+1.5% from last quarter</small>
              <div class="compliance-breakdown">
                <small>Mining Licenses: 100% | Tax Filings: 97% | Environmental: 99%</small>
              </div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Pending Submissions</h3>
            </div>
            <div class="card-body">
              <p>2</p>
              <small>Due within 7 days</small>
              <div class="urgent-items">
                <small>üü° Monthly Royalty Return | üî¥ Environmental Impact Report</small>
              </div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Regulatory Alerts</h3>
            </div>
            <div class="card-body">
              <p>1</p>
              <small>New regulation updates</small>
              <div class="alert-summary">
                <small>Mining Act Amendment 2024</small>
              </div>
            </div>
          </div>
          <div class="metric-card card">
            <div class="card-header">
              <h3>Next Audit</h3>
            </div>
            <div class="card-body">
              <p>45 days</p>
              <small>Eswatini Revenue Authority</small>
            </div>
          </div>
        </div>

        <!-- Regulatory Framework Management -->
        <div class="user-form-container">
          <h4>üá∏üáø Eswatini Regulatory Framework</h4>
          <div class="regulatory-tabs">
            <button class="tab-btn active" data-tab="#eswatini-local">Local Laws</button>
            <button class="tab-btn" data-tab="#sadc-regional">SADC Regional</button>
            <button class="tab-btn" data-tab="#fiscal-tax">Fiscal & Tax</button>
            <button class="tab-btn" data-tab="#environmental">Environmental</button>
          </div>
          
          <div class="tab-content active" id="eswatini-local">
            <div class="regulatory-section">
              <h5>Eswatini Mining Laws & Regulations</h5>
              <div class="grid-4">
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Mining Act 2007</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Primary mining legislation governing mineral rights and royalties</p>
                    <div class="regulation-meta">
                      <span>Last Updated: Jan 2024</span>
                      <span>Next Review: Jun 2024</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Mines & Minerals Regulations 2011</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Detailed operational requirements and royalty calculation methods</p>
                    <div class="regulation-meta">
                      <span>Last Updated: Dec 2023</span>
                      <span>Next Review: Mar 2024</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Mineral Royalty Regulations</h6>
                    <span class="status-badge warning">Review Required</span>
                  </div>
                  <div class="regulation-details">
                    <p>Specific royalty rates and payment procedures</p>
                    <div class="regulation-meta">
                      <span>Amendment Due: Feb 2024</span>
                      <span>Action Required: Rate Review</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Mining License Conditions</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>License-specific terms and compliance requirements</p>
                    <div class="regulation-meta">
                      <span>All Licenses Current</span>
                      <span>Renewals: Q3 2024</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-content" id="sadc-regional">
            <div class="regulatory-section">
              <h5>SADC Regional Compliance</h5>
              <div class="grid-4">
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>SADC Mining Protocol</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Regional harmonization of mining policies and standards</p>
                    <div class="regulation-meta">
                      <span>Cross-border compliance maintained</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Regional Tax Treaties</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Double taxation agreements with neighboring countries</p>
                    <div class="regulation-meta">
                      <span>SA, Mozambique, Botswana treaties active</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-content" id="fiscal-tax">
            <div class="regulatory-section">
              <h5>Fiscal & Tax Structure Compliance</h5>
              <div class="grid-4">
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Eswatini Revenue Authority</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Monthly royalty returns and tax submissions</p>
                    <div class="regulation-meta">
                      <span>Next Filing: 15th Feb 2024</span>
                      <span>Rate: 3-10% depending on mineral</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Corporate Income Tax</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>27.5% corporate tax rate for mining companies</p>
                    <div class="regulation-meta">
                      <span>Annual Return: 30th Jun 2024</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Withholding Tax</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>15% on dividends, 10% on interest and royalties</p>
                    <div class="regulation-meta">
                      <span>Monthly submissions current</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>VAT Registration</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>15% VAT on applicable transactions</p>
                    <div class="regulation-meta">
                      <span>Monthly returns up to date</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-content" id="environmental">
            <div class="regulatory-section">
              <h5>Environmental Compliance</h5>
              <div class="grid-4">
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Environmental Impact Assessment</h6>
                    <span class="status-badge warning">Update Due</span>
                  </div>
                  <div class="regulation-details">
                    <p>Annual environmental compliance reporting</p>
                    <div class="regulation-meta">
                      <span>Due: 28th Feb 2024</span>
                      <span>Status: In Progress</span>
                    </div>
                  </div>
                </div>
                <div class="regulation-card">
                  <div class="regulation-header">
                    <h6>Water Use License</h6>
                    <span class="status-badge compliant">Compliant</span>
                  </div>
                  <div class="regulation-details">
                    <p>Water usage reporting and permit compliance</p>
                    <div class="regulation-meta">
                      <span>Permit valid until Dec 2025</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Regulatory Reporting & Submissions -->
        <div class="user-form-container">
          <h4>üìã Regulatory Reporting & Submissions</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="reporting-jurisdiction">Jurisdiction</label>
              <select id="reporting-jurisdiction">
                <option>Eswatini Revenue Authority</option>
                <option>Ministry of Natural Resources</option>
                <option>Environmental Authority</option>
                <option>SADC Secretariat</option>
              </select>
            </div>
            <div class="form-group">
              <label for="report-type">Report Type</label>
              <select id="report-type">
                <option>Monthly Royalty Return</option>
                <option>Quarterly Production Report</option>
                <option>Annual Compliance Certificate</option>
                <option>Environmental Impact Assessment</option>
                <option>Tax Return</option>
                <option>SADC Regional Report</option>
              </select>
            </div>
            <div class="form-group">
              <label for="reporting-period">Reporting Period</label>
              <select id="reporting-period">
                <option>January 2024</option>
                <option>Q4 2023</option>
                <option>Annual 2023</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Generate Report</button>
              <button class="btn btn-success">Submit to Authority</button>
            </div>
          </div>
          
          <!-- Submission Tracking -->
          <h5>Recent Submissions & Deadlines</h5>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Report Type</th>
                  <th>Jurisdiction</th>
                  <th>Due Date</th>
                  <th>Status</th>
                  <th>Submission Date</th>
                  <th>Reference Number</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Monthly Royalty Return</td>
                  <td>Eswatini Revenue Authority</td>
                  <td>15 Feb 2024</td>
                  <td><span class="status-badge pending">Pending</span></td>
                  <td>-</td>
                  <td>-</td>
                  <td>
                    <button class="btn btn-primary btn-sm">Prepare</button>
                    <button class="btn btn-success btn-sm">Submit</button>
                  </td>
                </tr>
                <tr>
                  <td>Environmental Report</td>
                  <td>Environmental Authority</td>
                  <td>28 Feb 2024</td>
                  <td><span class="status-badge warning">In Progress</span></td>
                  <td>-</td>
                  <td>-</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">Continue</button>
                  </td>
                </tr>
                <tr>
                  <td>Quarterly Production</td>
                  <td>Ministry of Natural Resources</td>
                  <td>31 Jan 2024</td>
                  <td><span class="status-badge compliant">Submitted</span></td>
                  <td>29 Jan 2024</td>
                  <td>MNR-Q4-2023-001</td>
                  <td>
                    <button class="btn btn-secondary btn-sm">View</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Compliance Alerts & Notifications -->
        <div class="user-form-container">
          <h4>üö® Compliance Alerts & Deadlines</h4>
          <div class="alert-dashboard">
            <div class="alert-item urgent">
              <div class="alert-icon">üî¥</div>
              <div class="alert-content">
                <h6>Environmental Impact Report Overdue</h6>
                <p>Due: 28 Feb 2024 | Days Overdue: 2</p>
                <div class="alert-actions">
                  <button class="btn btn-danger btn-sm">Submit Now</button>
                  <button class="btn btn-secondary btn-sm">Request Extension</button>
                </div>
              </div>
            </div>
            <div class="alert-item warning">
              <div class="alert-icon">üü°</div>
              <div class="alert-content">
                <h6>Monthly Royalty Return Due Soon</h6>
                <p>Due: 15 Feb 2024 | Days Remaining: 5</p>
                <div class="alert-actions">
                  <button class="btn btn-primary btn-sm">Prepare Report</button>
                </div>
              </div>
            </div>
            <div class="alert-item info">
              <div class="alert-icon">üîµ</div>
              <div class="alert-content">
                <h6>New Mining Act Amendment</h6>
                <p>Effective: 1 Apr 2024 | Review required for compliance impact</p>
                <div class="alert-actions">
                  <button class="btn btn-secondary btn-sm">Review Changes</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Regulatory Calendar -->
        <div class="user-form-container">
          <h4>üìÖ Regulatory Calendar</h4>
          <div class="calendar-view">
            <div class="calendar-header">
              <button class="btn btn-secondary">&lt; Previous</button>
              <h5>February 2024</h5>
              <button class="btn btn-secondary">Next &gt;</button>
            </div>
            <div class="calendar-grid">
              <!-- Simplified calendar representation -->
              <div class="calendar-week">
                <div class="calendar-day">
                  <span class="day-number">15</span>
                  <div class="day-events">
                    <div class="event royalty">Royalty Return Due</div>
                  </div>
                </div>
                <div class="calendar-day">
                  <span class="day-number">28</span>
                  <div class="day-events">
                    <div class="event environmental">Environmental Report</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- New Regulatory Management Section -->
      <section id="regulatory-management">
        <div class="page-header">
          <div class="page-title">
            <h1>Regulatory Management</h1>
            <p>Comprehensive management of jurisdictional requirements and regulatory frameworks</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Regulatory Assessment</button>
            <button class="btn btn-success">Update Compliance Matrix</button>
          </div>
        </div>

        <!-- Jurisdictional Requirements Matrix -->
        <div class="user-form-container">
          <h4>üèõÔ∏è Multi-Jurisdictional Compliance Matrix</h4>
          <div class="jurisdiction-matrix">
            <div class="grid-4">
              <div class="jurisdiction-card">
                <div class="jurisdiction-header">
                  <h6>üá∏üáø Eswatini (Local)</h6>
                  <span class="compliance-score">94%</span>
                </div>
                <div class="jurisdiction-requirements">
                  <div class="requirement-item">
                    <span class="requirement-name">Mining Licenses</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                  <div class="requirement-item">
                    <span class="requirement-name">Royalty Payments</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                  <div class="requirement-item">
                    <span class="requirement-name">Environmental Permits</span>
                    <span class="requirement-status warning">‚ö†Ô∏è</span>
                  </div>
                  <div class="requirement-item">
                    <span class="requirement-name">Tax Filings</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                </div>
              </div>
              
              <div class="jurisdiction-card">
                <div class="jurisdiction-header">
                  <h6>üèõÔ∏è SADC Regional</h6>
                  <span class="compliance-score">100%</span>
                </div>
                <div class="jurisdiction-requirements">
                  <div class="requirement-item">
                    <span class="requirement-name">Regional Protocols</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                  <div class="requirement-item">
                    <span class="requirement-name">Cross-border Trade</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                  <div class="requirement-item">
                    <span class="requirement-name">Environmental Standards</span>
                    <span class="requirement-status compliant">‚úÖ</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tax Structure Management -->
        <div class="user-form-container">
          <h4>üí∞ Tax Structure & Rates Management</h4>
          <div class="tax-structure-grid">
            <div class="tax-category">
              <h6>Mineral Royalties</h6>
              <div class="tax-rates">
                <div class="rate-item">
                  <span>Coal</span>
                  <span class="rate">3%</span>
                  <span class="basis">of gross value</span>
                </div>
                <div class="rate-item">
                  <span>Iron Ore</span>
                  <span class="rate">5%</span>
                  <span class="basis">of gross value</span>
                </div>
                <div class="rate-item">
                  <span>Quarry Products</span>
                  <span class="rate">E15/m¬≥</span>
                  <span class="basis">flat rate</span>
                </div>
                <div class="rate-item">
                  <span>Precious Minerals</span>
                  <span class="rate">10%</span>
                  <span class="basis">of gross value</span>
                </div>
              </div>
            </div>
            
            <div class="tax-category">
              <h6>Corporate Taxes</h6>
              <div class="tax-rates">
                <div class="rate-item">
                  <span>Corporate Income Tax</span>
                  <span class="rate">27.5%</span>
                  <span class="basis">on net profit</span>
                </div>
                <div class="rate-item">
                  <span>Withholding Tax (Dividends)</span>
                  <span class="rate">15%</span>
                  <span class="basis">on distributions</span>
                </div>
                <div class="rate-item">
                  <span>VAT</span>
                  <span class="rate">15%</span>
                  <span class="basis">on applicable sales</span>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-actions">
            <button class="btn btn-primary">Update Tax Rates</button>
            <button class="btn btn-secondary">Export Tax Schedule</button>
          </div>
        </div>
      </section>

      <!-- My Profile -->
      <section id="profile">
        <div class="page-header">
          <div class="page-title">
            <h1>My Profile</h1>
            <p>Manage your account details and preferences</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Save Changes</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Profile Information</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="profile-username">Username</label>
              <input type="text" id="profile-username" placeholder="Username" aria-describedby="profile-username-validation">
              <div class="validation-error" id="profile-username-validation">Username is required</div>
            </div>
            <div class="form-group">
              <label for="profile-email">Email</label>
              <input type="email" id="profile-email" placeholder="Email" aria-describedby="profile-email-validation">
              <div class="validation-error" id="profile-email-validation">Email is required</div>
            </div>
            <div class="form-group">
              <label for="profile-department">Department</label>
              <select id="profile-department" aria-describedby="profile-department-validation">
                <option>Select Department</option>
                <option>Finance</option>
                <option>Operations</option>
                <option>Compliance</option>
                <option>Audit</option>
                <option>Management</option>
              </select>
              <div class="validation-error" id="profile-department-validation">Department is required</div>
            </div>
          </div>
          <h4>Change Password</h4>
          <div class="grid-4">
            <div class="form-group">
              <label for="current-password">Current Password</label>
              <input type="password" id="current-password" placeholder="Current Password" aria-describedby="current-password-validation">
              <div class="validation-error" id="current-password-validation">Current password is required</div>
            </div>
            <div class="form-group">
              <label for="new-profile-password">New Password</label>
              <input type="password" id="new-profile-password" placeholder="New Password" aria-describedby="new-profile-password-validation">
              <div class="validation-error" id="new-profile-password-validation">New password is required</div>
            </div>
            <div class="form-group">
              <label for="confirm-profile-password">Confirm New Password</label>
              <input type="password" id="confirm-profile-password" placeholder="Confirm New Password" aria-describedby="confirm-profile-password-validation">
              <div class="validation-error" id="confirm-profile-password-validation">Passwords must match</div>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn btn-secondary">Cancel</button>
            <button class="btn btn-success">Update Profile</button>
          </div>
        </div>
      </section>

      <!-- Logout -->
      <section id="logout">
        <div class="page-header">
          <div class="page-title">
            <h1>Logout</h1>
            <p>Securely end your session</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-danger" id="confirm-logout-btn">Confirm Logout</button>
          </div>
        </div>
        <div class="user-form-container">
          <p>Click the button above to log out of the Mining Royalties Manager. Ensure all changes are saved before logging out.</p>
          <div class="logout-warning">
            <h5>‚ö†Ô∏è Before you logout:</h5>
            <ul>
              <li>Save any unsaved changes</li>
              <li>Complete any pending operations</li>
              <li>Close any open reports or forms</li>
            </ul>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script type="text/javascript">
  // Modernized file handling with ES6+
  class FileManager {
    constructor() {
      this.isXlsx = false;
      this.xlsxFileLookup = new Map();
      this.fileData = new Map();
    }

    isFilledCell = (cell) => cell !== '' && cell != null;

    async loadFileData(filename) {
      if (this.isXlsx && this.xlsxFileLookup.has(filename)) {
        try {
          const workbook = XLSX.read(this.fileData.get(filename), { type: 'base64' });
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];

          // Convert sheet to JSON to filter blank rows
          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          
          // Filter out blank rows using modern array methods
          const filteredData = jsonData.filter(row => row.some(this.isFilledCell));

          // Find header row with improved logic
          const headerRowIndex = this.findHeaderRow(filteredData);

          // Convert filtered JSON back to CSV
          const csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
          return XLSX.utils.sheet_to_csv(csv, { header: 1 });
        } catch (error) {
          console.error('File processing error:', error);
          return "";
        }
      }
      return this.fileData.get(filename) || "";
    }

    findHeaderRow(filteredData) {
      const headerRowIndex = filteredData.findIndex((row, index) =>
        row.filter(this.isFilledCell).length >= (filteredData[index + 1]?.filter(this.isFilledCell).length || 0)
      );
      return (headerRowIndex === -1 || headerRowIndex > 25) ? 0 : headerRowIndex;
    }
  }

  // Initialize global file manager
  const fileManager = new FileManager();
  
  // Expose legacy global variables for compatibility
  const gk_isXlsx = fileManager.isXlsx;
  const gk_xlsxFileLookup = fileManager.xlsxFileLookup;
  const gk_fileData = fileManager.fileData;
  const filledCell = fileManager.isFilledCell;
  const loadFileData = (filename) => fileManager.loadFileData(filename);
  </script>

  <script>
  // Modern ES6+ Application Class
  class RoyaltiesManager {
    constructor() {
      this.sidebar = null;
      this.loginSection = null;
      this.appContainer = null;
      this.loadingScreen = null;
      this.charts = new Map();
      this.notifications = new Set();
      
      this.init();
    }

    // Modern initialization with async/await
    async init() {
      try {
        await this.waitForDOM();
        this.initializeElements();
        this.setupEventListeners();
        await this.simulateLoading();
        this.showLoginSection();
      } catch (error) {
        console.error('Application initialization failed:', error);
      }
    }

    waitForDOM() {
      return new Promise(resolve => {
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', resolve);
        } else {
          resolve();
        }
      });
    }

    initializeElements() {
      this.sidebar = document.getElementById('sidebar');
      this.loginSection = document.getElementById('login-section');
      this.appContainer = document.getElementById('app-container');
      this.loadingScreen = document.getElementById('loading-screen');
    }

    async simulateLoading() {
      return new Promise(resolve => setTimeout(resolve, 2000));
    }

    showLoginSection() {
      this.loadingScreen.style.display = 'none';
      this.loginSection.style.display = 'flex';
    }

    setupEventListeners() {
      // Modern event delegation
      document.addEventListener('click', this.handleGlobalClick.bind(this));
      document.addEventListener('submit', this.handleGlobalSubmit.bind(this));
      
      // Setup navigation
      this.setupNavigation();
      this.setupUserManagement();
    }

    handleGlobalClick(event) {
      const { target } = event;
      
      // Handle navigation clicks
      if (target.closest('.sidebar nav a')) {
        this.handleNavigationClick(event);
      }
      
      // Handle button clicks with data attributes
      if (target.dataset.action) {
        this.handleActionButton(event);
      }
    }

    handleGlobalSubmit(event) {
      if (event.target.matches('.login-form')) {
        this.handleLogin(event);
      }
    }

    handleNavigationClick(event) {
      event.preventDefault();
      const link = event.target.closest('a');
      const href = link.getAttribute('href');
      
      if (href?.startsWith('#')) {
        const sectionId = href.substring(1);
        this.showSection(sectionId);
        this.closeMobileSidebar();
      }
    }

    async handleLogin(event) {
      event.preventDefault();
      
      try {
        // Simulate authentication
        await this.authenticate();
        
        this.loginSection.style.display = 'none';
        this.appContainer.style.display = 'flex';
        this.sidebar.classList.add('active');
        
        // Initialize charts after app is visible
        setTimeout(() => this.initializeCharts(), 100);
      } catch (error) {
        this.showNotification('Login failed. Please try again.', 'error');
      }
    }

    async authenticate() {
      // Simulate API call
      return new Promise(resolve => setTimeout(resolve, 500));
    }

    showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('main > section').forEach(section => {
        section.style.display = 'none';
      });
      
      // Show target section
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
        targetSection.style.display = 'block';
        this.scrollToTop();
      }

      this.updateActiveNavigation(sectionId);
    }

    updateActiveNavigation(sectionId) {
      document.querySelectorAll('.sidebar nav a').forEach(link => {
        link.classList.remove('active');
      });
      
      const activeLink = document.querySelector(`.sidebar nav a[href="#${sectionId}"]`);
      activeLink?.classList.add('active');
    }

    scrollToTop() {
      document.querySelector('.main-content')?.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    closeMobileSidebar() {
      if (window.innerWidth <= 768) {
        this.sidebar.classList.remove('active');
      }
    }

    setupNavigation() {
      // Show dashboard by default
      this.showSection('dashboard');
    }

    async initializeCharts() {
      try {
        await Promise.all([
          this.createRevenueChart(),
          this.createProductionChart()
        ]);
      } catch (error) {
        console.warn('Chart initialization failed:', error);
        this.showFallbackCharts();
      }
    }

    async createRevenueChart() {
      const canvas = document.getElementById('revenue-trends-chart');
      if (!canvas || typeof Chart === 'undefined') return;

      const ctx = canvas.getContext('2d');
      
      // Destroy existing chart
      this.charts.get('revenue')?.destroy();
      
      const chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
          datasets: [{
            label: 'Revenue (E)',
            data: [500000, 600000, 750000, 700000, 800000, 900000],
            borderColor: '#1a365d',
            backgroundColor: 'rgba(26, 54, 93, 0.2)',
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: true, position: 'top' }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: value => `E ${value.toLocaleString()}`
              }
            },
            x: { grid: { display: false } }
          },
          interaction: { intersect: false, mode: 'index' }
        }
      });
      
      this.charts.set('revenue', chart);
    }

    async createProductionChart() {
      const canvas = document.getElementById('production-by-entity-chart');
      if (!canvas || typeof Chart === 'undefined') return;

      const ctx = canvas.getContext('2d');
      
      // Destroy existing chart
      this.charts.get('production')?.destroy();
      
      const chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: [
            'Kwalini Quarry', 'Mbabane Quarry', 'Sidvokodvo Quarry',
            'Maloma Colliery', 'Ngwenya Mine', 'Malolotja Mine'
          ],
          datasets: [{
            label: 'Production Volume (m¬≥)',
            data: [45000, 38000, 42000, 55000, 28000, 32000],
            backgroundColor: ['#1a365d', '#2563eb', '#059669', '#dc2626', '#d97706', '#7c3aed'],
            borderColor: ['#1a365d', '#2563eb', '#059669', '#dc2626', '#d97706', '#7c3aed'],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: { padding: 20, usePointStyle: true, font: { size: 12 } }
            },
            tooltip: {
              callbacks: {
                label: (context) => {
                  const { label, parsed } = context;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((parsed / total) * 100).toFixed(1);
                  return `${label}: ${parsed.toLocaleString()} m¬≥ (${percentage}%)`;
                }
              }
            }
          },
          interaction: { intersect: false }
        }
      });
      
      this.charts.set('production', chart);
    }

    showFallbackCharts() {
      const containers = ['#revenue-trends-chart', '#production-by-entity-chart'];
      containers.forEach(selector => {
        const container = document.querySelector(selector)?.parentNode;
        if (container) {
          container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #64748b;">Chart data will be loaded shortly...</p>';
        }
      });
    }

    setupUserManagement() {
      // Enhanced button functionality using modern event delegation
      this.setupUserManagementButtons();
      this.setupTabSwitching();
    }

    setupUserManagementButtons() {
      const buttons = {
        'View Audit Log': this.handleViewAuditLog.bind(this),
        'Export Report': this.handleExportReport.bind(this),
        'Add User': this.handleAddUser.bind(this)
      };

      Object.entries(buttons).forEach(([text, handler]) => {
        const button = Array.from(document.querySelectorAll('#user-management .page-actions .btn'))
          .find(btn => btn.textContent.includes(text));
        
        if (button) {
          button.addEventListener('click', handler);
        }
      });
    }

    async handleViewAuditLog(event) {
      event.preventDefault();
      
      const auditLogSection = document.querySelector('#user-management .user-form-container:last-child');
      if (!auditLogSection) {
        this.showNotification('Security Audit Log section not found', 'error');
        return;
      }

      this.showSection('user-management');
      
      await this.sleep(300);
      
      this.scrollToElement(auditLogSection);
      this.highlightElement(auditLogSection);
      this.showNotification('Scrolled to Security Audit Log section', 'info');
    }

    async handleExportReport(event) {
      event.preventDefault();
      
      this.showNotification('Generating user management report...', 'info');
      
      await this.sleep(1500);
      
      this.showNotification('User management report exported successfully!', 'success');
      this.downloadFile('user_management_report.csv', 'User Management Report\nGenerated on: ' + new Date().toLocaleString());
    }

    handleAddUser(event) {
      event.preventDefault();
      
      const addUserForm = document.querySelector('#user-management .user-form-container:first-child');
      if (!addUserForm) return;

      this.scrollToElement(addUserForm);
      this.highlightElement(addUserForm, 'success');
      
      // Focus first input
      setTimeout(() => {
        addUserForm.querySelector('input')?.focus();
      }, 500);
    }

    scrollToElement(element) {
      element.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    highlightElement(element, type = 'primary') {
      const colors = {
        primary: { bg: 'rgba(26, 54, 93, 0.05)', border: '#1a365d' },
        success: { bg: 'rgba(56, 161, 105, 0.05)', border: 'var(--success-color)' }
      };
      
      const color = colors[type];
      element.style.transition = 'background-color 0.3s ease, border-color 0.3s ease';
      element.style.backgroundColor = color.bg;
      element.style.borderColor = color.border;
      
      setTimeout(() => {
        element.style.backgroundColor = '';
        element.style.borderColor = '';
      }, 3000);
    }

    setupTabSwitching() {
      document.addEventListener('click', (event) => {
        if (event.target.matches('.tab-btn, .regulatory-tabs .tab-btn')) {
          this.handleTabSwitch(event);
        }
      });
    }

    handleTabSwitch(event) {
      const button = event.target;
      const tabId = button.getAttribute('data-tab');
      const parentContainer = button.closest('.user-form-container, .regulatory-section');
      
      if (!parentContainer || !tabId) return;

      // Remove active classes
      parentContainer.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      parentContainer.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

      // Add active classes
      button.classList.add('active');
      parentContainer.querySelector(tabId)?.classList.add('active');
    }

    // Modern notification system with better UX
    showNotification(message, type = 'info') {
      // Remove existing notifications
      document.querySelectorAll('.notification-toast').forEach(n => n.remove());
      
      const notification = this.createNotificationElement(message, type);
      document.body.appendChild(notification);
      
      this.animateNotification(notification);
    }

    createNotificationElement(message, type) {
      const types = {
        success: { bg: '#dcfce7', border: '#bbf7d0', color: '#166534', icon: '‚úÖ' },
        error: { bg: '#fef2f2', border: '#fecaca', color: '#dc2626', icon: '‚ùå' },
        warning: { bg: '#fef3c7', border: '#fde68a', color: '#92400e', icon: '‚ö†Ô∏è' },
        info: { bg: '#dbeafe', border: '#93c5fd', color: '#1e40af', icon: '‚ÑπÔ∏è' }
      };
      
      const config = types[type];
      const notification = document.createElement('div');
      notification.className = 'notification-toast';
      
      notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; z-index: 10000;
        background: ${config.bg}; color: ${config.color};
        padding: 1rem 1.5rem; border-radius: 8px;
        border: 1px solid ${config.border};
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        max-width: 400px; display: flex; align-items: center;
        gap: 0.75rem; font-weight: 500;
        transform: translateX(100%); transition: transform 0.3s ease;
      `;
      
      notification.innerHTML = `
        <span style="font-size: 1.2rem;">${config.icon}</span>
        <span>${message}</span>
        <button onclick="this.parentElement.remove()" style="
          background: none; border: none; color: ${config.color};
          cursor: pointer; font-size: 1.2rem; margin-left: auto; opacity: 0.7;
        ">√ó</button>
      `;
      
      return notification;
    }

    animateNotification(notification) {
      setTimeout(() => notification.style.transform = 'translateX(0)', 100);
      
      setTimeout(() => {
        if (notification.parentElement) {
          notification.style.transform = 'translateX(100%)';
          setTimeout(() => notification.remove(), 300);
        }
      }, 5000);
    }

    downloadFile(filename, content) {
      const link = document.createElement('a');
      link.href = `data:text/csv;charset=utf-8,${encodeURIComponent(content)}`;
      link.download = `${filename.split('.')[0]}_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
    }

    sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
  }

  // Initialize the modern application
  const app = new RoyaltiesManager();
</script>

<!-- Modern Icon Management System -->
<script type="module">
  class IconManager {
    constructor() {
      this.iconMap = new Map([
        ['fa-home', 'üè†'], ['fa-user', 'üë§'], ['fa-users', 'üë•'],
        ['fa-file-invoice', 'üìÑ'], ['fa-file-contract', 'üìã'],
        ['fa-shield-alt', 'üõ°Ô∏è'], ['fa-chart-bar', 'üìä'],
        ['fa-envelope', '‚úâÔ∏è'], ['fa-bell', 'üîî'],
        ['fa-check-circle', '‚úÖ'], ['fa-sign-out-alt', 'üö™'],
        ['fa-lock', 'üîí'], ['fa-eye', 'üëÅÔ∏è'], ['fa-clock', 'üïê'],
        ['fa-filter', 'üîΩ'], ['fa-gavel', '‚öñÔ∏è']
      ]);
      
      this.init();
    }

    async init() {
      try {
        this.suppressExtensionErrors();
        this.addStyles();
        this.replaceIcons();
        this.addMobileMenuToggle();
        this.observeChanges();
        
        // Delayed replacements for dynamic content
        [500, 1000, 2000].forEach(delay => {
          setTimeout(() => this.replaceIcons(), delay);
        });
      } catch (error) {
        console.warn('Icon manager initialization failed:', error);
      }
    }

    suppressExtensionErrors() {
      const originalError = console.error;
      const originalWarn = console.warn;
      
      console.error = (...args) => {
        const message = args.join(' ').toLowerCase();
        if (!this.shouldSuppressMessage(message)) {
          originalError.apply(console, args);
        }
      };

      console.warn = (...args) => {
        const message = args.join(' ').toLowerCase();
        if (!this.shouldSuppressMessage(message)) {
          originalWarn.apply(console, args);
        }
      };

      ['unhandledrejection', 'error'].forEach(event => {
        window.addEventListener(event, this.handleError.bind(this));
      });
    }

    shouldSuppressMessage(message) {
      const suppressPatterns = [
        'fontawesome', 'extension', 'chrome-extension', 'intervention',
        'listener indicated', 'message channel', 'runtime'
      ];
      return suppressPatterns.some(pattern => message.includes(pattern));
    }

    handleError(event) {
      const errorMessage = event.reason?.message || event.message || '';
      if (this.shouldSuppressMessage(errorMessage.toLowerCase())) {
        event.preventDefault();
        return false;
      }
    }

    replaceIcons() {
      document.querySelectorAll('[class*="fa-"]').forEach(element => {
        this.replaceElementIcon(element);
      });
    }

    replaceElementIcon(element) {
      const classList = Array.from(element.classList);
      let iconReplaced = false;
      
      for (const className of classList) {
        if (this.iconMap.has(className)) {
          this.applyIcon(element, this.iconMap.get(className));
          iconReplaced = true;
          break;
        }
      }
      
      if (!iconReplaced && classList.some(c => c.startsWith('fa-'))) {
        this.applyIcon(element, 'üìã');
      }
    }

    applyIcon(element, icon) {
      // Remove FontAwesome classes
      element.classList.forEach(cls => {
        if (cls.startsWith('fa')) {
          element.classList.remove(cls);
        }
      });
      
      // Add emoji icon if element is empty or minimal content
      if (!element.textContent.trim() || element.textContent.trim().length <= 2) {
        element.textContent = icon;
        element.classList.add('emoji-icon');
      }
    }

    addMobileMenuToggle() {
      if (document.querySelector('.mobile-menu-toggle')) return;
      
      const toggle = document.createElement('button');
      Object.assign(toggle, {
        className: 'mobile-menu-toggle',
        innerHTML: '‚ò∞',
        setAttribute: toggle.setAttribute.bind(toggle, 'aria-label', 'Toggle Menu')
      });
      
      toggle.onclick = () => {
        document.querySelector('.sidebar')?.classList.toggle('active');
      };
      
      document.body.appendChild(toggle);
    }

    addStyles() {
      if (document.querySelector('#modern-icon-styles')) return;
      
      const style = document.createElement('style');
      style.id = 'modern-icon-styles';
      style.textContent = this.getModernStyles();
      document.head.appendChild(style);
    }

    getModernStyles() {
      return `
        .emoji-icon {
          font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif !important;
          font-style: normal !important;
          font-weight: normal !important;
          display: inline-block;
          width: 1em;
          height: 1em;
          text-align: center;
          vertical-align: middle;
        }

        .mobile-menu-toggle {
          display: none;
          position: fixed;
          top: 1rem;
          left: 1rem;
          z-index: 1001;
          background: #1a365d;
          color: white;
          border: none;
          border-radius: 6px;
          padding: 0.75rem;
          cursor: pointer;
          font-size: 1.2rem;
          width: 48px;
          height: 48px;
        }

        @media (max-width: 768px) {
          .mobile-menu-toggle { display: flex !important; }
          .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
          .sidebar.active { transform: translateX(0); }
        }
      `;
    }

    observeChanges() {
      if (!window.MutationObserver) return;
      
      const observer = new MutationObserver(mutations => {
        let shouldReplace = false;
        
        mutations.forEach(mutation => {
          if (mutation.type === 'childList') {
            mutation.addedNodes.forEach(node => {
              if (node.nodeType === 1 && this.hasFontAwesomeClasses(node)) {
                shouldReplace = true;
              }
            });
          }
        });
        
        if (shouldReplace) {
          setTimeout(() => this.replaceIcons(), 50);
        }
      });

      observer.observe(document.body, { childList: true, subtree: true });
    }

    hasFontAwesomeClasses(node) {
      return node.classList && 
             Array.from(node.classList).some(c => c.startsWith('fa-'));
    }
  }

  // Initialize modern icon manager
  new IconManager();
</script>
</body>
</html>