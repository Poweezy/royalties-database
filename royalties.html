<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mining Royalties Manager</title>
  <link rel="stylesheet" href="royalties.css">
  <link rel="icon" type="image/png" sizes="192x192" href="./favicon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="./favicon-512.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2>Loading your workspace...</h2>
    </div>
  </div>

  <div class="login-section" id="loginSection">
    <div class="login-container">
      <div class="login-header">
        <div class="login-logo">MR</div>
        <h1>Mining Royalties Manager</h1>
        <p>Secure access to your royalty management system</p>
      </div>
      <div class="login-form">
        <div class="input-group">
          <i class="fas fa-user"></i>
          <input type="text" id="username" placeholder="Username" required>
          <div class="validation-error" id="usernameError">Username is required</div>
        </div>
        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input type="password" id="password" placeholder="Password" required>
          <button class="password-toggle" type="button" onclick="togglePassword()">
            <i class="fas fa-eye"></i>
          </button>
          <div class="validation-error" id="passwordError">Password is required</div>
        </div>
        <button class="btn btn-primary btn-large" onclick="login()">Sign In</button>
      </div>
      <div class="login-footer">
        <p>Demo Credentials: admin/admin123 or editor/editor123</p>
      </div>
    </div>
  </div>

  <div class="app-container" id="appContainer" style="display: none;">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">MR</div>
        <h2>Royalties Manager</h2>
        <button class="sidebar-close" onclick="toggleSidebar()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <nav>
        <ul>
          <li><a href="#dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
          <li><a href="#user-management"><i class="fas fa-users"></i> User Management</a></li>
          <li><a href="#royalty-records"><i class="fas fa-file-invoice"></i> Royalty Records</a></li>
          <li><a href="#contract-management"><i class="fas fa-file-contract"></i> Contract Management</a></li>
          <li><a href="#audit-dashboard"><i class="fas fa-shield-alt"></i> Audit Dashboard</a></li>
          <li><a href="#reporting-analytics"><i class="fas fa-chart-bar"></i> Reporting & Analytics</a></li>
          <li><a href="#compliance"><i class="fas fa-check-circle"></i> Compliance</a></li>
          <li><a href="#profile"><i class="fas fa-user-circle"></i> My Profile</a></li>
          <li><a href="#notifications"><i class="fas fa-bell"></i> Notifications <span>0</span></a></li>
          <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <section id="dashboard">
        <div class="page-header">
          <div class="page-title">
            <h1>Dashboard</h1>
            <p>Welcome back, User</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Admin</button>
            <span>0</span>
          </div>
        </div>
        <div class="charts-grid">
          <div class="card">
            <div class="card-header"><h3>Total Royalties (YTD)</h3></div>
            <div class="card-body"><p>E0.00</p><small>+0% from last year</small></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Active Entities</h3></div>
            <div class="card-body"><p>0</p><small>No change</small></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Compliance Rate</h3></div>
            <div class="card-body"><p>0%</p></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Pending Approvals</h3></div>
            <div class="card-body"><p>0</p></div>
          </div>
        </div>
        <div class="charts-grid">
          <div class="card">
            <div class="card-header"><h3>Royalty Trends</h3></div>
            <div class="card-body">
              <select>
                <option>Last 6 months</option>
                <option>Last year</option>
                <option>Last 2 years</option>
              </select>
              <div id="royalty-trends-chart"></div>
            </div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Mineral Distribution</h3></div>
            <div class="card-body"><div id="mineral-distribution-chart"></div></div>
          </div>
        </div>
      </section>

      <section id="user-management">
        <div class="page-header">
          <div class="page-title">
            <h1>User Management</h1>
            <p>Manage users with role-based access control and security monitoring</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary">View Audit Log</button>
            <button class="btn btn-secondary">Export Report</button>
            <button class="btn btn-primary">Add User</button>
          </div>
        </div>
        <div class="charts-grid">
          <div class="card">
            <div class="card-header"><h3>Active Users</h3></div>
            <div class="card-body"><p>3</p><small>Currently online</small></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Failed Logins</h3></div>
            <div class="card-body"><p>0</p><small>Last 24 hours</small></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Security Alerts</h3></div>
            <div class="card-body"><p>None</p><small>All systems secure</small></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Password Compliance</h3></div>
            <div class="card-body"><p>100%</p><small>Meeting security standards</small></div>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Add New User</h4>
          <div class="grid-4">
            <div class="form-group">
              <label>Username</label>
              <input type="text" placeholder="Username">
              <div class="validation-success">‚úì Username available</div>
            </div>
            <div class="form-group">
              <label>Email Address</label>
              <input type="email" placeholder="Valid email address">
            </div>
            <div class="form-group">
              <label>Role</label>
              <select>
                <option>Select Role</option>
                <option>üëë Admin (Full Access)</option>
                <option>‚úèÔ∏è Editor (Read/Write)</option>
                <option>üëÅÔ∏è Viewer (Read Only)</option>
                <option>üîç Auditor (Audit Access)</option>
              </select>
            </div>
            <div class="form-group">
              <label>Department</label>
              <select>
                <option>Select Department</option>
                <option>üí∞ Finance</option>
                <option>‚öôÔ∏è Operations</option>
                <option>üìã Compliance</option>
                <option>üîç Audit</option>
                <option>üëî Management</option>
              </select>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input type="password" placeholder="Password">
              <div class="password-strength-meter">
                <div class="strength-bar strength-weak"><div class="strength-bar-fill"></div></div>
                <span class="strength-text">Password Strength</span>
              </div>
            </div>
            <div class="form-group">
              <label>Confirm Password</label>
              <input type="password" placeholder="Confirm Password">
            </div>
            <div class="form-group">
              <label>Account Expires</label>
              <input type="date" placeholder="Leave blank for no expiration">
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox"> Force password change on first login
              </label>
            </div>
            <div class="form-group">
              <button class="btn btn-secondary">Cancel</button>
              <button class="btn btn-primary">Create User</button>
            </div>
          </div>
        </div>
        <div class="user-form-container">
          <h4>User Accounts</h4>
          <div class="grid-4">
            <div class="form-group">
              <select>
                <option>All Roles</option>
                <option>Admin</option>
                <option>Editor</option>
                <option>Viewer</option>
                <option>Auditor</option>
              </select>
            </div>
            <div class="form-group">
              <select>
                <option>All Status</option>
                <option>Active</option>
                <option>Locked</option>
                <option>Expired</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Email</th>
                <th>Role</th>
                <th>Department</th>
                <th>Status</th>
                <th>Last Login</th>
                <th>Failed Attempts</th>
                <th>Expires</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="user-form-container">
          <h4>Security Audit Log</h4>
          <div class="grid-4">
            <div class="form-group">
              <label>From Date</label>
              <input type="date">
            </div>
            <div class="form-group">
              <label>To Date</label>
              <input type="date">
            </div>
            <div class="form-group">
              <label>Action Type</label>
              <select>
                <option>All Actions</option>
                <option>Login</option>
                <option>Logout</option>
                <option>Create User</option>
                <option>Modify User</option>
                <option>Delete User</option>
                <option>Failed Login</option>
                <option>Password Change</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>User</th>
                <th>Action</th>
                <th>Target</th>
                <th>IP Address</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="royalty-records">
        <div class="page-header">
          <div class="page-title">
            <h1>Royalty Records</h1>
            <p>Manage and review all royalty payments</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Record Payment</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Record Royalty Payment</h4>
          <div class="grid-4">
            <div class="form-group">
              <label>Entity</label>
              <select>
                <option>Select Entity</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
              <div class="validation-error">Entity is required</div>
            </div>
            <div class="form-group">
              <label>Mineral</label>
              <select>
                <option>Select Mineral</option>
                <option>Coal</option>
                <option>Iron Ore</option>
                <option>Green Chert</option>
                <option>Gravel</option>
                <option>River Sand</option>
                <option>Plaster Sand</option>
                <option>Quarried Stone</option>
              </select>
              <div class="validation-error">Mineral is required</div>
            </div>
            <div class="form-group">
              <label>Volume (m¬≥)</label>
              <input type="number" placeholder="Volume">
              <div class="validation-error">Volume must be a positive number</div>
            </div>
            <div class="form-group">
              <label>Royalty Tariff (E/m¬≥)</label>
              <input type="number" placeholder="Tariff">
              <div class="validation-error">Tariff must be a positive number</div>
            </div>
            <div class="form-group">
              <label>Date</label>
              <input type="date">
              <div class="validation-error">Date is required</div>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Save Royalty</button>
            </div>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Royalty Records Table</h4>
          <div class="grid-4">
            <div class="form-group">
              <select>
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
              <button class="btn btn-secondary">Export Report</button>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Entity</th>
                <th>Mineral</th>
                <th>Volume (m¬≥)</th>
                <th>Tariff (E/m¬≥)</th>
                <th>Royalties (E)</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="contract-management">
        <div class="page-header">
          <div class="page-title">
            <h1>Contract Management</h1>
            <p>Manage royalty agreements for mines and quarries</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Add Contract</button>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Add Contract</h4>
          <div class="grid-4">
            <div class="form-group">
              <label>Entity</label>
              <select>
                <option>Select Entity</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <label>Royalty Rate (E/m¬≥)</label>
              <input type="number" placeholder="Rate">
            </div>
            <div class="form-group">
              <label>Start Date</label>
              <input type="date">
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Save Contract</button>
            </div>
          </div>
        </div>
        <table class="data-table">
          <thead>
            <tr>
              <th>Entity</th>
              <th>Royalty Rate (E/m¬≥)</th>
              <th>Start Date</th>
              <th>Document</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section id="audit-dashboard">
        <div class="page-header">
          <div class="page-title">
            <h1>Audit Dashboard</h1>
            <p>Review discrepancies and audit reports</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary">Export Audit Report</button>
          </div>
        </div>
        <div class="user-form-container">
          <div class="grid-4">
            <div class="form-group">
              <select>
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Apply Filters</button>
            </div>
          </div>
          <h4>Discrepancies</h4>
          <table class="data-table">
            <thead>
              <tr>
                <th>Project</th>
                <th>Mineral</th>
                <th>Declared (m¬≥)</th>
                <th>Verified (m¬≥)</th>
                <th>Outstanding (E)</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="reporting-analytics">
        <div class="page-header">
          <div class="page-title">
            <h1>Reporting & Analytics</h1>
            <p>Generate royalty and audit reports</p>
          </div>
        </div>
        <div class="user-form-container">
          <h4>Generate Reports</h4>
          <div class="grid-4">
            <div class="form-group">
              <label>Report Type</label>
              <select>
                <option>Select Report Type</option>
                <option>Royalty Summary</option>
                <option>Audit Discrepancies</option>
              </select>
            </div>
            <div class="form-group">
              <label>Entity</label>
              <select>
                <option>All Entities</option>
                <option>Kwalini Quarry</option>
                <option>Mbabane Quarry</option>
                <option>Sidvokodvo Quarry</option>
                <option>Maloma Colliery</option>
                <option>Ngwenya Mine</option>
                <option>Malolotja Mine</option>
              </select>
            </div>
            <div class="form-group">
              <label>Date Range</label>
              <select>
                <option>2024</option>
                <option>2025</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn btn-primary">Generate Report</button>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Report Name</th>
                <th>Type</th>
                <th>Entity</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="compliance">
        <div class="page-header">
          <div class="page-title">
            <h1>Compliance Dashboard</h1>
          </div>
        </div>
        <div class="charts-grid">
          <div class="card">
            <div class="card-header"><h3>Submission Deadlines</h3></div>
            <div class="card-body"><p>Next deadline: 30/06/2025</p></div>
          </div>
          <div class="card">
            <div class="card-header"><h3>Discrepancy Alerts</h3></div>
            <div class="card-body"><p>1 discrepancy found</p></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    function togglePassword() {
      const passwordInput = document.getElementById('password');
      const toggleIcon = document.querySelector('.password-toggle i');
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
      }
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('hidden');
    }

    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      if (username && password) {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('appContainer').style.display = 'flex';
        document.getElementById('loadingScreen').style.display = 'none';
      } else {
        document.getElementById('usernameError').style.display = username ? 'none' : 'flex';
        document.getElementById('passwordError').style.display = password ? 'none' : 'flex';
      }
    }

    function logout() {
      document.getElementById('loginSection').style.display = 'flex';
      document.getElementById('appContainer').style.display = 'none';
      document.getElementById('username').value = '';
      document.getElementById('password').value = '';
    }

    window.onload = () => {
      setTimeout(() => {
        document.getElementById('loadingScreen').style.display = 'none';
      }, 2000);
    };
  </script>
</body>
</html>