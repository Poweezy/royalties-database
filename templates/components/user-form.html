<div class="user-form-container" id="add-user-form-container" style="display: none;">
  <div class="section-header">
    <h4><i class="fas fa-user-plus"></i> Add New User Account</h4>
    <div class="table-actions">
      <button class="btn btn-secondary btn-sm" id="close-add-user-form" title="Close form">
        <i class="fas fa-times"></i> Close
      </button>
    </div>
  </div>
  
  <form id="add-user-form" novalidate>
    <div class="form-tabs">
      <button type="button" class="tab-btn active" data-tab="#basic-info-tab">
        <i class="fas fa-user"></i> Basic Information
      </button>
      <button type="button" class="tab-btn" data-tab="#permissions-tab">
        <i class="fas fa-shield-alt"></i> Permissions & Security
      </button>
      <button type="button" class="tab-btn" data-tab="#preferences-tab">
        <i class="fas fa-cog"></i> Preferences
      </button>
    </div>

    <!-- Basic Information Tab -->
    <div class="tab-content active" id="basic-info-tab">
      <div class="grid-4">
        <!-- Username Field -->
        <div class="form-group">
          <label for="new-username">
            <i class="fas fa-user"></i> Username *
          </label>
          <input 
            type="text" 
            id="new-username" 
            name="username" 
            placeholder="Enter unique username" 
            required 
            aria-describedby="new-username-error new-username-success"
            autocomplete="off"
            minlength="3"
            maxlength="50"
            pattern="^[a-zA-Z0-9._-]+$"
          >
          <div class="validation-success" id="new-username-success" style="display: none;">
            <i class="fas fa-check-circle"></i> Username is available
          </div>
          <div class="validation-error" id="new-username-error" style="display: none;">
            <i class="fas fa-exclamation-circle"></i> Username is required and must be unique
          </div>
          <small class="form-help">3-50 characters, letters, numbers, dots, dashes, underscores only</small>
        </div>
        
        <!-- Full Name Field -->
        <div class="form-group">
          <label for="new-fullname">
            <i class="fas fa-id-card"></i> Full Name *
          </label>
          <input 
            type="text" 
            id="new-fullname" 
            name="fullname" 
            placeholder="Enter full name" 
            required 
            minlength="2"
            maxlength="100"
          >
          <div class="validation-error" id="new-fullname-error" style="display: none;">
            <i class="fas fa-exclamation-circle"></i> Full name is required
          </div>
          <small class="form-help">Employee's full legal name</small>
        </div>
        
        <!-- Email Field -->
        <div class="form-group">
          <label for="new-email">
            <i class="fas fa-envelope"></i> Email Address *
          </label>
          <input 
            type="email" 
            id="new-email" 
            name="email" 
            placeholder="user@eswacaa.sz" 
            required 
          >
          <div class="validation-success" id="new-email-success" style="display: none;">
            <i class="fas fa-check-circle"></i> Email format is valid
          </div>
          <div class="validation-error" id="new-email-error" style="display: none;">
            <i class="fas fa-exclamation-circle"></i> Valid email address is required
          </div>
          <small class="form-help">Official organization email address</small>
        </div>
        
        <!-- Phone Field -->
        <div class="form-group">
          <label for="new-phone">
            <i class="fas fa-phone"></i> Phone Number
          </label>
          <input 
            type="tel" 
            id="new-phone" 
            name="phone" 
            placeholder="+268 7612 3456" 
            pattern="[+]?[0-9\s\-\(\)]+"
          >
          <small class="form-help">Contact phone number with country code</small>
        </div>
        
        <!-- Role Field -->
        <div class="form-group">
          <label for="new-role">
            <i class="fas fa-user-tag"></i> Role *
          </label>
          <select id="new-role" name="role" required>
            <option value="">Select user role</option>
            <option value="Administrator">Administrator - Full system access</option>
            <option value="Editor">Editor - Read/write access</option>
            <option value="Viewer">Viewer - Read-only access</option>
            <option value="Auditor">Auditor - Audit and compliance access</option>
            <option value="Finance">Finance Manager - Financial data access</option>
          </select>
          <div class="validation-error" id="new-role-error" style="display: none;">
            <i class="fas fa-exclamation-circle"></i> User role selection is required
          </div>
          <small class="form-help">Determines system access permissions</small>
        </div>
        
        <!-- Department Field -->
        <div class="form-group">
          <label for="new-department">
            <i class="fas fa-building"></i> Department *
          </label>
          <select id="new-department" name="department" required>
            <option value="">Select department</option>
            <option value="Management">Management</option>
            <option value="Finance">Finance</option>
            <option value="Audit">Audit</option>
            <option value="Legal">Legal</option>
            <option value="Operations">Operations</option>
            <option value="IT">Information Technology</option>
          </select>
          <div class="validation-error" id="new-department-error" style="display: none;">
            <i class="fas fa-exclamation-circle"></i> Department selection is required
          </div>
          <small class="form-help">User's organizational department</small>
        </div>
        
        <!-- Employee ID Field -->
        <div class="form-group">
          <label for="new-employee-id">
            <i class="fas fa-id-badge"></i> Employee ID
          </label>
          <input 
            type="text" 
            id="new-employee-id" 
            name="employee_id" 
            placeholder="EMP001" 
            pattern="[A-Z]{3}[0-9]{3,6}"
          >
          <small class="form-help">Official employee identification number</small>
        </div>
        
        <!-- Account Expiry Field -->
        <div class="form-group">
          <label for="new-expires" class="optional">
            <i class="fas fa-calendar-alt"></i> Account Expires (Optional)
          </label>
          <input 
            type="date" 
            id="new-expires" 
            name="expires" 
            min=""
          >
          <small class="form-help">Leave blank for no expiration date</small>
        </div>
      </div>
    </div>

    <!-- Permissions & Security Tab -->
    <div class="tab-content" id="permissions-tab">
      <div class="grid-2">
        <div class="form-section">
          <h5><i class="fas fa-lock"></i> Password Setup</h5>
          
          <!-- Password Field -->
          <div class="form-group">
            <label for="new-password">
              <i class="fas fa-lock"></i> Initial Password *
            </label>
            <div class="password-input-container">
              <input 
                type="password" 
                id="new-password" 
                name="password" 
                placeholder="Enter secure password" 
                required 
                minlength="8"
              >
              <button type="button" class="password-toggle-btn" id="toggle-new-password">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <div class="password-strength-meter" id="password-strength">
              <div class="strength-bar">
                <div class="strength-bar-fill"></div>
              </div>
              <p class="strength-text">Password strength: Weak</p>
            </div>
            <div class="validation-error" id="new-password-error" style="display: none;">
              <i class="fas fa-exclamation-circle"></i> Password must be at least 8 characters long
            </div>
            <small class="form-help">Minimum 8 characters with letters, numbers, and symbols</small>
          </div>
          
          <!-- Confirm Password Field -->
          <div class="form-group">
            <label for="new-password-confirm">
              <i class="fas fa-lock"></i> Confirm Password *
            </label>
            <input 
              type="password" 
              id="new-password-confirm" 
              name="password_confirm" 
              placeholder="Confirm password" 
              required 
            >
            <div class="validation-success" id="password-match-success" style="display: none;">
              <i class="fas fa-check-circle"></i> Passwords match
            </div>
            <div class="validation-error" id="password-match-error" style="display: none;">
              <i class="fas fa-exclamation-circle"></i> Passwords do not match
            </div>
            <small class="form-help">Re-enter the password for confirmation</small>
          </div>

          <!-- Security Options -->
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" name="force_password_change" checked>
              <span>Force password change on first login</span>
            </label>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" name="enable_2fa">
              <span>Enable two-factor authentication</span>
            </label>
          </div>
        </div>

        <div class="form-section">
          <h5><i class="fas fa-shield-alt"></i> User Permissions</h5>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="read" checked disabled>
              <span>Read Access (Required)</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="write" id="perm-write">
              <span>Write Access - Create and modify records</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="delete" id="perm-delete">
              <span>Delete Access - Remove records permanently</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="admin" id="perm-admin">
              <span>Administrative Access - Manage users and system</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="audit" id="perm-audit">
              <span>Audit Access - View audit logs and reports</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="finance" id="perm-finance">
              <span>Financial Access - Manage financial data</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" name="permissions[]" value="export" id="perm-export">
              <span>Export Access - Export data and reports</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Preferences Tab -->
    <div class="tab-content" id="preferences-tab">
      <div class="grid-3">
        <div class="form-group">
          <label for="new-language">
            <i class="fas fa-language"></i> Language
          </label>
          <select id="new-language" name="language">
            <option value="en">English</option>
            <option value="ss">siSwati</option>
            <option value="zu">isiZulu</option>
          </select>
          <small class="form-help">Preferred interface language</small>
        </div>

        <div class="form-group">
          <label for="new-timezone">
            <i class="fas fa-clock"></i> Timezone
          </label>
          <select id="new-timezone" name="timezone">
            <option value="Africa/Mbabane">Africa/Mbabane (CAT)</option>
            <option value="Africa/Johannesburg">Africa/Johannesburg (SAST)</option>
            <option value="UTC">UTC</option>
          </select>
          <small class="form-help">User's timezone for date/time display</small>
        </div>

        <div class="form-group">
          <label for="new-date-format">
            <i class="fas fa-calendar"></i> Date Format
          </label>
          <select id="new-date-format" name="date_format">
            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
          </select>
          <small class="form-help">Preferred date display format</small>
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" name="email_notifications" checked>
            <span>Enable email notifications</span>
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" name="system_notifications" checked>
            <span>Enable system notifications</span>
          </label>
        </div>

        <div class="form-group">
          <label class="checkbox-label">
            <input type="checkbox" name="login_alerts">
            <span>Send login alerts</span>
          </label>
        </div>
      </div>
    </div>
    
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" id="cancel-add-user">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button type="button" class="btn btn-warning" id="reset-form">
        <i class="fas fa-undo"></i> Reset Form
      </button>
      <button type="submit" class="btn btn-success" id="create-user-btn" disabled>
        <i class="fas fa-user-plus"></i> Create User Account
      </button>
    </div>
  </form>
</div>
