<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Component Loader</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-info { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .sidebar-test { border: 2px solid #ccc; padding: 10px; margin: 10px 0; min-height: 200px; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Component Loader Debug Test</h1>
    
    <div class="debug-info">
        <h3>Environment Info:</h3>
        <p><strong>Protocol:</strong> <span id="protocol"></span></p>
        <p><strong>Current URL:</strong> <span id="current-url"></span></p>
        <p><strong>Unified Component Loader Available:</strong> <span id="loader-available"></span></p>
    </div>

    <div class="debug-info">
        <h3>Test Results:</h3>
        <div id="test-results"></div>
    </div>

    <div class="sidebar-test">
        <h3>Sidebar Test Container:</h3>
        <div id="sidebar-test">
            <!-- Sidebar will be loaded here -->
        </div>
    </div>

    <script src="js/unified-component-loader.js"></script>
    <script>
        // Display environment info
        document.getElementById('protocol').textContent = window.location.protocol;
        document.getElementById('current-url').textContent = window.location.href;
        
        function addResult(message, isError = false) {
            const div = document.createElement('div');
            div.className = isError ? 'error' : 'success';
            div.textContent = message;
            document.getElementById('test-results').appendChild(div);
        }

        // Wait for component loader to initialize
        setTimeout(async () => {
            const loaderAvailable = window.unifiedComponentLoader ? 'Yes' : 'No';
            document.getElementById('loader-available').textContent = loaderAvailable;
            
            if (!window.unifiedComponentLoader) {
                addResult('ERROR: Unified Component Loader not available!', true);
                return;
            }

            addResult('Unified Component Loader is available');
            
            // Test sidebar loading
            try {
                addResult('Attempting to load sidebar component...');
                const container = document.getElementById('sidebar-test');
                const result = await window.unifiedComponentLoader.loadComponent('sidebar', container);
                
                if (result && result.success) {
                    addResult(`SUCCESS: Sidebar loaded from source: ${result.source}`);
                    
                    // Check if navigation links are present
                    const navLinks = container.querySelectorAll('.nav-link');
                    addResult(`Found ${navLinks.length} navigation links`);
                    
                    if (navLinks.length > 0) {
                        addResult('Navigation links found:');
                        navLinks.forEach(link => {
                            const section = link.getAttribute('data-section');
                            const text = link.textContent.trim();
                            addResult(`  - ${section}: ${text}`);
                        });
                    } else {
                        addResult('ERROR: No navigation links found in loaded sidebar!', true);
                    }
                } else {
                    addResult(`ERROR: Failed to load sidebar: ${result ? result.error : 'Unknown error'}`, true);
                }
            } catch (error) {
                addResult(`ERROR: Exception loading sidebar: ${error.message}`, true);
                console.error('Sidebar loading error:', error);
            }
        }, 1000);
    </script>
</body>
</html>
